{"version":3,"sources":["my_projects_list.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"my_projects_list.js","sourcesContent":["$(document).ready(function() {\n    var table_list_projects = null;\n    var tables = [];\n    Pace.track(function() {\n        table_list_projects = $(\"#table-my-list-projects\").DataTable({\n            ajax: '/admin/profesor/service/myprojects/all',\n            dom: `<'row'<'col-sm-6 reports-list-items'f><'col-sm-6'<'#searchFilterPeriodo'>>>\n                  <'row'<'col-sm-12'tr>>\n                  <'row'<'col-sm-5'i><'col-sm-7'p>>`,\n            initComplete: function(settings) {\n                var api = this.api();\n                var searchPeriodo = `<div class=\"form-group select-periodos\">\n                            <select name=\"periodo\" class=\"form-control\" id=\"periodo\" style=\"width:100%;\"></select>\n                        </div>`;\n                $(\"#searchFilterPeriodo\").html(searchPeriodo);\n                var data = $(\"#ls-periodos-user\").data('ls-periodos-user');\n                // PREPARE DATA\n                var options = [{ id: 'all', text: 'Todos' }];\n                $.each(data, function (k, v) {\n                    options.push({id: v.id, text: v.corte});\n                })\n                $(\"#periodo\").select2({\n                    data: options\n                })\n                $(\"#periodo\").on('change', function (e) {\n                    var periodo = e.target.value;\n                    var url = '/admin/profesor/service/myprojects/periodo/' + periodo;\n                    api.ajax.url(url).load();\n                });\n            },\n            drawCallback: function(settings) {\n                var api = this.api();\n                $.each(api.rows().nodes(), function(x, tr){\n                    $(tr).find('[data-toggle=tooltip]').tooltip();\n                    // FUNCTION LOAD PROYECTO\n                    $(tr).find('.btn-load-proyecto').off('click').on('click', function(e) {\n                        e.preventDefault();\n                        var id = $(this).data('id');\n                        var tr_n = $(tr).closest('tr');\n                        var row = api.row( tr_n );\n                        if($(this).hasClass('active')) {\n                            row.child.hide(\"slow\");\n                            $(this).removeClass('active');\n                            return;\n                        }\n                        $(this).parent().find('a').removeClass('active');\n                        $(this).addClass('active');\n                        if(row.child.isShown()){\n                            row.child.hide(\"slow\");\n                        }\n                        row.child( show_view_proyecto(row.data()) ).show();\n                        tr_n.next().find(\".view_html\").slideDown(200);\n                    });\n                    // FUNCTION LOAD LIST PROVIDERS\n                    $(tr).find('.btn-load-list-providers').off('click').on('click', function(e) {\n                        e.preventDefault();\n                        var btnLoadListProviders = this;\n                        var pup_id = $(this).data('pup-id');\n                        var n_proyecto = $(this).data('nombre-proyecto');\n                        var tr_n = $(tr).closest('tr');\n                        var row = api.row( tr_n );\n                        $(this).parent().find('a').removeClass('active');\n                        if(row.child.isShown()){\n                            row.child.hide(\"slow\");\n                        }\n\n                        $(\"#form-add-list-providers\").find('[name=pup_id]').val(pup_id);\n                        $(\"#form-add-list-providers\").find('#nombre-proyecto').text(n_proyecto);\n\n                        $(\"#btn-add-new-providers\").off().on('click', function(e) {\n                            e.preventDefault();\n                            var btn = '<button type=\"button\" style=\"border-radius:50%;font-size:11px;\" class=\"btn btn-danger btn-xs\"><i class=\"fa fa-remove\"></i></button>';\n                            var element = $(\"#addListProviders\").find('.row-origin').clone(true);\n                            var n_tr = $(\"#list-new-providers\").find('tbody tr').length;\n                            element.removeClass('row-origin');\n                            element.addClass('row-cloned');\n                            element.find('input').val('').removeClass(\"error\");\n                            element.find('label.error').remove();\n                            element.find('.btn-actions').html(btn);\n                            element.find('.btn-actions').find('button').on('click', function(e) {\n                                e.preventDefault();\n                                $(this).parents('tr').remove();\n                            })\n                            var inputs = element.find('input');\n                            $.each(inputs, function(x, input) {\n                                var id = $(input).attr('id');\n                                $(input).attr('id', id + \"_\" + (n_tr + 1));\n                                if(id == 'ci') {   \n                                    $(input).numeric_input({\n                                        decimal: '.',\n                                        numberOfDecimals: null\n                                    });\n                                }\n                            })\n                            $(\"#addListProviders\").find('#list-new-providers tbody').append(element);\n                        })\n\n                        // SOLICITAR GRUPO O GRUPOS DE PRESTADORES\n                        Pace.track(function() {\n                            var rq = $.ajax({\n                                url: \"/admin/profesor/api/service/groups/pup/\" + pup_id,\n                                type: \"GET\",\n                                dataType: \"json\"\n                            })\n                            rq.done(function(json) {\n                                if(json.response == \"ok\") {\n                                    var groups = [];\n                                    $.each(json.groups, function(x, g) {\n                                        var tab = `<li class=\"my-tab-group-li\"><a id=\"my-tab-group-${g.id}\" class=\"my-tab-group\" href=\"#tab_${g.id}\" data-toggle=\"tab\" aria-expanded=\"true\">Grupo ${g.grupo}</a></li>`;\n\n                                        // ADD TABS\n                                        $(\"#group-tabs\").append(tab);\n                                        // CREATE OBJ AUTOCOMPLETE\n                                        var obj = {\n                                            value: `${g.grupo}`,\n                                            data: `${g.id}`\n                                        }\n                                        groups.push(obj);\n\n                                        // ./LOAD LIST FOR PROVIDERS\n                                        var headTable = `<div class=\"tab-pane content-table\" id=\"tab_${g.id}\">\n                                        <table id=\"table-${g.id}\" class=\"table table-bordered table-prestadores-bordered table-condensed\" style=\"font-size: 12px;\">\n                                            <thead>\n                                                <th style=\"width:115px;padding-right:5px;\">Nº de cédula</th>\n                                                <th style=\"width:142px;\">Primer nombre</th>\n                                                <th style=\"width:143px;\">Segundo nombre</th>\n                                                <th style=\"width:144px;\">Primer apellido</th>\n                                                <th>Segundo apellido</th>\n                                                <th style=\"width:35px;\"></th>\n                                            </thead>\n                                        </table>\n                                        </div>`;\n\n                                        $(\"#group-tabs-content\").append(headTable);\n\n                                        // ./REQUEST LIST PROVIDERS\n                                        $(\"#my-tab-group-\" + g.id).one('click', function(){\n                                            Pace.track(function() {\n                                                tables[x] = $(\"#table-\" + g.id).DataTable({\n                                                    ajax: '/admin/profesor/service/myprojects/providers/group/' + g.id,\n                                                    drawCallback: function(settings) {\n                                                        var api_ = this.api();\n                                                        $.each(api_.rows().nodes(), function(x, tr){\n                                                            // FUNCTION EDITAR PRESTADOR\n                                                            $(tr).find('.btn-edit-provider').on('click', function() {\n                                                                var providerId = $(this).data('id');\n                                                                var rqEditProvider = $.ajax({\n                                                                    url: '/admin/profesor/service/myprojects/provider/' + providerId,\n                                                                    type: 'GET',\n                                                                    dataType: 'json'\n                                                                })\n                                                                rqEditProvider.done(function(json) {\n                                                                    var form = $(\"#form-edit-list-providers\");\n                                                                    form.find(\"[name=provider_id]\").val(json.provider.id);\n                                                                    form.find(\"[name=ci]\").val(json.provider.ci);\n                                                                    form.find(\"[name=firstname]\").val(json.provider.firstname);\n                                                                    form.find(\"[name=middlename]\").val(json.provider.middlename);\n                                                                    form.find(\"[name=primary_lastname]\").val(json.provider.primary_lastname);\n                                                                    form.find(\"[name=second_lastname]\").val(json.provider.second_lastname);\n\n                                                                    $(\"#editListProviders\").modal({\n                                                                        show: true,\n                                                                        backdrop: 'static',\n                                                                        keyboard: false\n                                                                    });\n                                                                    // VALIDATE FORM UPDATE PRESTADOR\n                                                                    form.validate({\n                                                                        submitHandler: function(form) {\n                                                                            var data = $(form).serialize();\n                                                                            rqUpdateProvider = $.ajax({\n                                                                                url: '/admin/profesor/service/myprojects/provider/' + providerId,\n                                                                                data: data,\n                                                                                type: 'POST',\n                                                                                dataType: 'json'\n                                                                            })\n                                                                            rqUpdateProvider.done(function(json) {\n                                                                                console.log(json)\n                                                                                if(json.response == 'ok') {\n                                                                                    $(\"#editListProviders\").modal('hide');\n                                                                                    api_.ajax.reload();\n                                                                                }\n                                                                            })\n                                                                            rqUpdateProvider.fail(function(jqXHR, textStatus) {\n                                                                                Utils.displayErrors(jqXHR);\n                                                                            })\n                                                                        }\n                                                                    })\n                                                                })\n                                                                rqEditProvider.fail(function(jqXHR, textStatus) {\n                                                                    console.log(jqXHR);\n                                                                    console.log(textStatus);\n                                                                })\n                                                            });\n\n                                                            // FUNCTION REMOVER PROVIDER\n                                                            $(tr).find('.btn-remove-provider').off('click').on('click', function(e) {\n                                                                e.preventDefault();\n                                                                var id = $(this).data('id');\n                                                                swal({\n                                                                    title: \"Estas seguro?\",\n                                                                    text: \"¿ Realmente desea eliminarlo ?<br><br>\",\n                                                                    type: \"warning\",\n                                                                    showCancelButton: true,\n                                                                    confirmButtonColor: \"#DD6B55\",\n                                                                    confirmButtonText: \"Si, eliminarlo!\",\n                                                                    closeOnConfirm: false\n                                                                },\n                                                                function(){\n                                                                    Pace.track(function() {\n                                                                        // Ajax request\n                                                                        $.ajax({\n                                                                            url: '/admin/profesor/service/myprojects/provider/delete/' + id,\n                                                                            type: 'GET',\n                                                                            dataType: 'JSON',\n                                                                            beforeSend: function() {\n                                                                                swal.disableButtons();\n                                                                            },\n                                                                            success: function(json) {\n                                                                                if(json.response == \"ok\")\n                                                                                {\n                                                                                    swal(\"Eliminado!\", \"Se ha eliminado correctamente.\", \"success\");\n                                                                                    api_.ajax.reload();\n                                                                                }\n                                                                            },\n                                                                            error: function(jqXHR) {\n                                                                                Utils.displayErrors(jqXHR);\n                                                                            }\n                                                                        })\n                                                                    })\n                                                                    // /.PACE\n                                                                })\n                                                                // /.FUNCTION\n                                                            });\n                                                        })\n                                                    },\n                                                    ordering : false,\n                                                    paging: false,\n                                                    pagingType: \"simple_numbers\",\n                                                    pageLength: 8,\n                                                    lengthChange: false,\n                                                    searching: false,\n                                                    info: false,\n                                                    displayStart: 0,\n                                                    autoWidth: false,\n                                                    language: {\n                                                        loadingRecords: \"Cargando...\",\n                                                        emptyTable:     \"No se han registrado prestadores de servicio en este proyecto\",\n                                                        info:           \"Mostrando _START_ a _END_ de _TOTAL_ registros\",\n                                                        infoEmpty:      \"Mostrando 0 a 0 de 0 registros\",\n                                                        zeroRecords:    \"No hay prestadores de servicio registrados...\",\n                                                        search: \"\",\n                                                        searchPlaceholder: \"Buscar en lista de roles...\",\n                                                        infoFiltered: \" - filtrado para _MAX_ registros\",\n                                                        paginate: {\n                                                            first:      \"Primero\",\n                                                            last:       \"Último\",\n                                                            next:       \"Siguiente\",\n                                                            previous:   \"Anterior\"\n                                                        }\n                                                    },\n                                                    columns: [\n                                                        { data: 'ci' },\n                                                        { data: 'firstname' },\n                                                        { \n                                                            data: 'middlename',\n                                                            render: function(data, type, row) {\n                                                                if(row.middlename == null) {\n                                                                    return '<span style=\"color:#DDD;\">N/R</span>';\n                                                                }else{\n                                                                    return row.middlename;\n                                                                }\n                                                            } \n                                                        },\n                                                        { data: 'primary_lastname' },\n                                                        { \n                                                            data: 'second_lastname',\n                                                            render: function(data, type, row) {\n                                                                if(row.second_lastname == null) {\n                                                                    return '<span style=\"color:#DDD;\">N/R</span>';\n                                                                }else{\n                                                                    return row.second_lastname;\n                                                                }\n                                                            } \n                                                        },\n                                                        {\n                                                            className: 'box-actions',\n                                                            data: null,\n                                                            render: function(data, type, row) {\n                                                                return '<button type=\"button\" style=\"border-radius:50%;margin-right:3px;font-size:10px;\" class=\"btn btn-warning btn-xs btn-edit-provider\" data-id=\"'+ row.id +'\" data-toggle=\"tooltip\" data-container=\"body\" data-title=\"Editar prestador de servicio\"><i class=\"fa fa-pencil\"></i></button>'\n                                                                + '<button type=\"button\" style=\"border-radius:50%;margin-right:3px;font-size:10px;\" class=\"btn btn-danger btn-xs btn-remove-provider\" data-id=\"'+ row.id +'\" data-toggle=\"tooltip\" data-container=\"body\" data-title=\"Remover prestador de servicio\"><i class=\"fa fa-remove\"></i></button>';\n                                                            }\n                                                        }\n                                                    ]\n                                                });\n                                            })\n                                        })\n                                    })\n                                    \n                                    // ./AUTOCOMPLETE\n                                    $(\"#grupo\").autocomplete({\n                                        lookup: groups\n                                    });\n\n                                    // SHOW OR HIDE BTN SAVE PROVIDERS\n                                    $(\"#addListProviders\").find('.my-tab-group-li').on('click', function() {\n                                        $(\"#btn-save-new-provider\").hide();\n                                    })\n                                    $(\"#addListProviders\").find('#btn-tab-zero').on('click', function() {\n                                        $(\"#btn-save-new-provider\").show();\n                                    })\n                                    \n                                    // ./SHOW MODAL\n                                    $(\"#addListProviders\").modal({\n                                        show: true,\n                                        backdrop: 'static',\n                                        keyboard: false\n                                    })\n                                    // EVENT HIDEN MODAL\n                                    $(\"#addListProviders\").on('hide.bs.modal', function(){\n                                        $(\"#btn-save-new-provider\").show();\n                                    })\n                                }\n                            })\n                            rq.fail(function(jqXHR, textStatus) {\n                                Utils.displayErrors(jqXHR);\n                            })\n                        })\n                    });\n                    // FUNCTION REGISTRAR COMUNIDAD Y ASESOR\n                    $(tr).find('.btn-register-community').off('click').on('click', function(e) {\n                        e.preventDefault();\n                        var id = $(this).data('id');\n                        var pup_id = $(this).data('pup-id');\n                        var tr_n = $(tr).closest('tr');\n                        var row = api.row( tr_n );\n                        if($(this).hasClass('active')) {\n                            row.child.hide(\"slow\");\n                            $(this).removeClass('active');\n                            $(tr).removeClass('active');\n                            return;\n                        }\n                        $(this).parent().find('a').removeClass('active');\n                        $(this).addClass('active');\n                        $(tr).addClass('active');\n                        if ( row.child.isShown() ) {\n                            row.child.hide(\"slow\");\n                        }\n                        Pace.track(function() {\n                            $.ajax({\n                                url: \"/admin/profesor/service/myprojects/add/comunidad\",\n                                type: \"GET\",\n                                dataType: \"html\",\n                                success: function(data) {\n                                    // LOAD DATA COMUNIDAD\n                                    Pace.track(function() {\n                                        $.ajax({\n                                            url: \"/admin/profesor/service/myprojects/comunidad/project/\" + pup_id,\n                                            type: 'GET',\n                                            dataType: 'json',\n                                            success: function(json) {\n                                                \n                                                row.child( show_form_add_community(data) ).show();\n                                                tr_n.next().find(\".view_html\").slideDown(200);\n\n                                                var formAsesor = tr_n.next().find(\".view_html\").find(\"#form-register-asesor\")[0];\n                                                var formComunity = tr_n.next().find(\".view_html\").find(\"#form-register-comunity\")[0];\n                                                \n                                                $(formComunity.state).select2({\n                                                    placeholder: 'Seleccione una estado...'\n                                                });\n                                                $(formComunity.province).select2({\n                                                    placeholder: 'Seleccione una provincia...'\n                                                });\n                                                if (json.comunidad != null) {\n                                                    $(formComunity.state).on('change', function (e, dataAddress) {\n                                                        var value = e.target.value;\n                                                        var state = e.target.options[e.target.options.selectedIndex].dataset.id\n                                                        $(formComunity.province).children().remove();\n                                                        $(formComunity.province).select2(\"destroy\");\n                                                        // SELECT PROVINCE FROM LOCALITY\n                                                        Pace.track(function () {\n                                                            var getProvinces = $.ajax({\n                                                                url: '/admin/api/get/provinces/' + state,\n                                                                type: 'GET',\n                                                                dataType: 'json'\n                                                            });\n                                                            getProvinces.done(function (json) {\n                                                                $(formComunity.province).select2({\n                                                                    data: json.data\n                                                                });\n                                                                $.each($(formComunity.province).children(), function (x, op) {\n                                                                    $(op).attr('data-id', json.data[x].dataId);\n                                                                })\n                                                                // trigger provinces\n                                                                $(formComunity.province).val(dataAddress.province).trigger('change', dataAddress.locality);\n                                                            })\n                                                            getProvinces.fail(function (jqXHR, textStatus) {\n                                                                displayErrors(jqXHR);\n                                                            });\n                                                        })\n                                                        // ./PACE\n                                                    })\n                                                    $(formComunity.province).on('change', function (e, locality) {\n                                                        var value = e.target.value;\n                                                        var province = null;\n                                                        $.each(e.target.children, function (x, option) {\n                                                            if (option.value == value) {\n                                                                province = $(option).data('id');\n                                                            }\n                                                        })\n                                                        $(formComunity.locality).children().remove();\n                                                        // SELECT PROVINCE FROM LOCALITY\n                                                        Pace.track(function () {\n                                                            var getProvinces = $.ajax({\n                                                                url: '/admin/profesor/service/myprojects/comunidad/' + province,\n                                                                type: 'GET',\n                                                                dataType: 'json'\n                                                            });\n                                                            getProvinces.done(function (json) {\n                                                                $(formComunity.locality).select2({\n                                                                    data: json.data\n                                                                });\n                                                                $(formComunity.locality).val(locality).trigger('change');\n                                                            })\n                                                            getProvinces.fail(function (jqXHR, textStatus) {\n                                                                displayErrors(jqXHR);\n                                                            });\n                                                        })\n                                                        // ./PACE\n                                                    })\n                                                    // LOAD LOCALITY DEFAULT\n                                                } else {\n                                                    $(formComunity.state).on('change', function (e) {\n                                                        var value = e.target.value;\n                                                        var state = e.target.options[e.target.options.selectedIndex].dataset.id\n                                                        $(formComunity.province).children().remove();\n                                                        $(formComunity.province).select2(\"destroy\");\n                                                        // SELECT PROVINCE FROM LOCALITY\n                                                        Pace.track(function () {\n                                                            var getProvinces = $.ajax({\n                                                                url: '/admin/api/get/provinces/' + state,\n                                                                type: 'GET',\n                                                                dataType: 'json'\n                                                            });\n                                                            getProvinces.done(function (json) {\n                                                                $(formComunity.province).select2({\n                                                                    data: json.data\n                                                                });\n                                                                $.each($(formComunity.province).children(), function (x, op) {\n                                                                    $(op).attr('data-id', json.data[x].dataId);\n                                                                })\n                                                                // trigger provinces\n                                                                $(formComunity.province).trigger('change');\n                                                            })\n                                                            getProvinces.fail(function (jqXHR, textStatus) {\n                                                                displayErrors(jqXHR);\n                                                            });\n                                                        })\n                                                        // ./PACE\n                                                    })\n                                                    $(formComunity.province).on('change', function(e) {\n                                                        var value = e.target.value;\n                                                        var province = null;\n                                                        $.each(e.target.children, function(x, option) {\n                                                            if(option.value == value) {\n                                                                province = $(option).data('id');\n                                                            }\n                                                        })\n                                                        $(formComunity.locality).children().remove();\n                                                        // SELECT PROVINCE FROM LOCALITY\n                                                        Pace.track(function() {\n                                                            var getProvinces = $.ajax({\n                                                                url: '/admin/profesor/service/myprojects/comunidad/' + province,\n                                                                type: 'GET',\n                                                                dataType: 'json'\n                                                            });\n                                                            getProvinces.done(function(json) {\n                                                                $(formComunity.locality).select2({\n                                                                    data: json.data\n                                                                });\n                                                            })\n                                                            getProvinces.fail(function(jqXHR, textStatus) {\n                                                                displayErrors(jqXHR);\n                                                            });\n                                                        })\n                                                        // ./PACE\n                                                    })\n                                                    // LOAD LOCALITY DEFAULT\n                                                    $(formComunity.state).trigger('change');\n                                                }\n                                                // VALIDATE FORMA ADD ASESOR\n                                                $(formAsesor).validate({\n                                                    ignore: [],\n                                                    rules: {\n                                                        ci: {\n                                                            required: true,\n                                                            number: true,\n                                                            maxlength: 8,\n                                                            minlength: 7\n                                                        },\n                                                        firstname: {\n                                                            required: true,\n                                                            maxlength: 50\n                                                        },\n                                                        middlename: {\n                                                            required: false,\n                                                            maxlength: 50\n                                                        },\n                                                        primary_lastname: {\n                                                            required: true,\n                                                            maxlength: 50\n                                                        },\n                                                        second_lastname: {\n                                                            required: false,\n                                                            maxlength: 50\n                                                        },\n                                                        'codes[]': {\n                                                            required: true\n                                                        },\n                                                        'phones[]': {\n                                                            required: true,\n                                                            maxlength: 7,\n                                                            minlength: 7\n                                                        }\n                                                    }\n                                                });\n                                                // VALIDATE FORM COMUNITY\n                                                $(formComunity).validate({\n                                                    ignore: [],\n                                                    rules: {\n                                                        comunidad: {\n                                                            required: true,\n                                                            maxlength: 255\n                                                        },\n                                                        direccion: {\n                                                            required: true,\n                                                            maxlength: 150\n                                                        },\n                                                        sector: {\n                                                            required: false,\n                                                            maxlength: 255\n                                                        },\n                                                        locality: {\n                                                            required: true\n                                                        },\n                                                        province: {\n                                                            required: true\n                                                        },\n                                                    }\n                                                });\n\n                                                $(\"#btn-save-asesor_comunity\").on('click', function() {\n                                                    var status = false;\n                                                    \n                                                    if($(formAsesor).valid()) {\n                                                        if ($(formComunity).valid()) {\n                                                            status = true\n                                                        } else {\n                                                            var tab = tr_n.next().find(\".view_html\").find(\"[data-toggle=tab]\").parents(\"li\").removeClass(\"active\");\n                                                            var tab = tr_n.next().find(\".view_html\").find(\"[href=\\\"#tab_2\\\"]\").parents(\"li\").addClass(\"active\");\n                                                            tr_n.next().find(\".view_html\").find(\".tab-pane\").removeClass(\"active\");\n                                                            tr_n.next().find(\".view_html\").find(\"#tab_2\").addClass(\"active\");\n\n                                                            status = false;\n                                                        }\n                                                    }else{\n                                                        var tab = tr_n.next().find(\".view_html\").find(\"[data-toggle=tab]\").parents(\"li\").removeClass(\"active\");\n                                                        var tab = tr_n.next().find(\".view_html\").find(\"[href=\\\"#tab_1\\\"]\").parents(\"li\").addClass(\"active\");\n                                                        tr_n.next().find(\".view_html\").find(\".tab-pane\").removeClass(\"active\");\n                                                        tr_n.next().find(\".view_html\").find(\"#tab_1\").addClass(\"active\");\n\n                                                        status = false;\n                                                    }\n                                                    \n                                                    if(status) {\n                                                        var dataAsesor = $(formAsesor).serialize();\n                                                        var dataComunity = $(formComunity).serialize();\n                                                        var dataForms = dataAsesor + \"&\" + dataComunity;\n                                                        \n                                                        Pace.track(function () {\n                                                            $.ajax({\n                                                                url: \"/admin/profesor/service/myprojects/comunidad\",\n                                                                data: dataForms,\n                                                                type: 'POST',\n                                                                dataType: 'JSON',\n                                                                success: function (json) {\n                                                                    api.ajax.reload();\n                                                                    noty({\n                                                                        text: \"Se ha guardado correctamente\",\n                                                                        type: 'success',\n                                                                        theme: \"relax\",\n                                                                        timeout: 2000, // [integer|boolean] delay for closing event in milliseconds. Set false for sticky notifications\n                                                                        progressBar: true, // [boolean] - displays a progress bar\n                                                                        template: '<div class=\"noty_message\"><span class=\"fa fa-check\"></span> <span class=\"noty_text\"></span><div class=\"noty_close\"></div></div>',\n                                                                        animation: {\n                                                                            open: 'animated bounceInDown', // Animate.css class names\n                                                                            close: 'animated bounceOutUp', // Animate.css class names\n                                                                            easing: 'swing', // unavailable - no need\n                                                                            speed: 500 // unavailable - no need\n                                                                        }\n                                                                    })\n                                                                },\n                                                                error: function (jqXHR, textStatus) {\n                                                                    displayErrors(jqXHR);\n                                                                }\n                                                            })\n                                                        })\n                                                    }\n                                                });\n\n                                                // SET DATA TO FORM\n                                                $(formAsesor).find('[name=pup_id]').val(pup_id);\n                                                if(json.comunidad != null) {\n                                                    // SET DATOS DE COMUNIDAD\n                                                    $(formAsesor).prepend('<input type=\"hidden\" name=\"_method\" value=\"PUT\">');\n                                                    $(formAsesor).find('[name=comunidad_id]').val(json.comunidad.id);\n                                                    formComunity.comunidad.value = json.comunidad.nombre;\n                                                    formComunity.direccion.value = json.comunidad.direccion;\n                                                    formComunity.sector.value = json.comunidad.sector;\n                                                    Pace.track(function() {\n                                                        $(formComunity.state).val(json.comunidad.state).trigger('change', { locality: json.comunidad.localidad, province: json.comunidad.provincia });\n                                                    })\n                                                    formComunity.lugar_prestadores.value = json.comunidad.lugar_prestadores;\n                                                    formComunity.direccion_lugar.value = json.comunidad.direccion_lugar;\n                                                    // SET DATOS DE ASESOR COMUNITARIO\n                                                    $(formAsesor).find('[name=asesor_id]').val(json.comunidad.asesor_id);\n                                                    formAsesor.ci.value = json.comunidad.ci;\n                                                    formAsesor.firstname.value = json.comunidad.firstname;\n                                                    formAsesor.middlename.value = json.comunidad.middlename;\n                                                    formAsesor.primary_lastname.value = json.comunidad.primary_lastname;\n                                                    formAsesor.second_lastname.value = json.comunidad.second_lastname;\n                                                    $.each(json.comunidad.phones, function(x, phone) {\n                                                        if(x == 0) {\n                                                            $(formAsesor).find('[name=\"codes[]\"]').val(phone.code_id);\n                                                            formAsesor.phones.value = phone.number;\n                                                            $(formAsesor).find(\"[name='phones_id[]']\").val(phone.id);\n                                                        }else{\n                                                            global.add_phones(phone);\n                                                        }\n                                                    })\n                                                }else{\n                                                    $(formComunity.locality).trigger('change');\n                                                    tr_n.next().find(\".view_html\").find('#msg-alert').show();\n                                                }\n                                            }\n                                        })\n                                    })\n                                }\n                            })\n                        })\n                    });\n                    // FUNCTION LOAD ACTIVITIES LIST\n                    $(tr).find('.btn-load-activities').off('click').on('click', function (e) {\n                        e.preventDefault();\n                        var pup_id = $(this).data('pup-id');\n                        var tr_n = $(tr).closest('tr');\n                        var row = api.row(tr_n);\n                        if ($(this).hasClass('active')) {\n                            row.child.hide(\"slow\");\n                            $(this).removeClass('active');\n                            return;\n                        }\n                        $(this).parent().find('a').removeClass('active');\n                        $(this).addClass('active');\n                        if (row.child.isShown()) {\n                            row.child.hide(\"slow\");\n                        }\n\n                        Pace.track(function () {\n                            $.ajax({\n                                url: \"/admin/profesor/service/myprojects/view/activities\",\n                                type: \"GET\",\n                                dataType: \"html\",\n                                success: function (data) {\n                                    // LOAD DATA ACTIVITIES LIST\n                                    row.child(show_view_activities_list(data)).show();\n                                    tr_n.next().find(\".view_html\").slideDown(200);\n                                    // INIT DATATABLE\n                                    tr_n.next().find(\".view_html\").find(\"#table-my-list-activities\").DataTable({\n                                        ajax: '/admin/profesor/api/service/reports/pup/' + pup_id,\n                                        dom: `<'row'<'col-sm-6 reports-list-filter'f><'col-sm-6'>>\n                                              <'row'<'col-sm-12'tr>>\n                                              <'row'<'col-sm-5'i><'col-sm-7'p>>`,\n                                        drawCallback: function (settings) {\n                                            var api = this.api();\n                                            $.each(api.rows().nodes(), function (x, tr) {\n                                                $(tr).find('[data-toggle=tooltip]').tooltip();\n                                                // FUNCTION DETALLES DE LA ACTIVIDAD\n                                                $(tr).find('.btn-view-report').off('click').on('click', function (e) {\n                                                    e.preventDefault();\n                                                    var id = $(this).data('id');\n                                                    var tr_n = $(tr).closest('tr');\n                                                    var row = api.row(tr_n);\n                                                    if ($(this).hasClass('active')) {\n                                                        row.child.hide(\"slow\");\n                                                        $(this).removeClass('active');\n                                                        return;\n                                                    }\n                                                    $(this).parent().find('a').removeClass('active');\n                                                    $(this).addClass('active');\n                                                    if (row.child.isShown()) {\n                                                        row.child.hide(\"slow\");\n                                                    }\n                                                    row.child(show_view_activity(row.data())).show();\n                                                    tr_n.next().find(\".view_html\").slideDown(200);\n                                                    tr_n.next().find('td').first().css({ 'border-top': '2px solid #4879BE', 'border-bottom': '2px solid #4879BE', 'background-color': 'lightgoldenrodyellow' });\n                                                });\n                                                // FUNCTION DELETE ACTIVIDAD\n                                                $(tr).find('.btn-delete-report').off('click').on('click', function (e) {\n                                                    e.preventDefault();\n                                                    var id = $(this).data('id');\n\n                                                    swal({\n                                                        title: \"Estas seguro?\",\n                                                        text: \"¿ Realmente deseas eliminar esta actividad ?.<br><br><p class='sugerencia_error'>Recuerda, si la actividad tiene 24h o más de creada, no puede ser eliminada.<p><br><br>\",\n                                                        type: \"warning\",\n                                                        html: true,\n                                                        showCancelButton: true,\n                                                        confirmButtonColor: \"#DD6B55\",\n                                                        confirmButtonText: \"Si, eliminar!\",\n                                                        closeOnConfirm: false\n                                                    },\n                                                        function () {\n                                                            Pace.track(function () {\n                                                                // Ajax request\n                                                                $.ajax({\n                                                                    url: '/admin/profesor/service/reporte/delete/' + id,\n                                                                    type: 'GET',\n                                                                    dataType: 'JSON',\n                                                                    beforeSend: function () {\n                                                                        swal.disableButtons();\n                                                                    },\n                                                                    success: function (json) {\n                                                                        if (json.response == \"ok\") {\n                                                                            swal(\"Eliminado!\", \"La actividad se ha eliminado con éxito.\", \"success\");\n                                                                            api.ajax.reload();\n                                                                        }\n                                                                    },\n                                                                    error: function (jqXHR) {\n                                                                        Utils.displayErrors(jqXHR);\n                                                                    }\n                                                                })\n                                                            })\n                                                            // /.PACE\n                                                        })\n                                                    // /.FUNCTION\n                                                });\n                                            })\n                                        },\n                                        ordering: false,\n                                        pagingType: \"simple_numbers\",\n                                        pageLength: 5,\n                                        lengthChange: false,\n                                        searching: true,\n                                        info: true,\n                                        displayStart: 0,\n                                        autoWidth: false,\n                                        language: {\n                                            loadingRecords: \"Cargando...\",\n                                            emptyTable: \"No hay registro de actividades en este proyecto\",\n                                            info: \"Mostrando _START_ a _END_ de _TOTAL_ registros\",\n                                            infoEmpty: \"Mostrando 0 a 0 de 0 registros\",\n                                            zeroRecords: \"No se encontraron actividades...\",\n                                            search: \"\",\n                                            searchPlaceholder: \"Buscar en lista de actividades...\",\n                                            infoFiltered: \" - filtrado para _MAX_ registros\",\n                                            paginate: {\n                                                first: \"Primero\",\n                                                last: \"Último\",\n                                                next: \"Siguiente\",\n                                                previous: \"Anterior\"\n                                            }\n                                        },\n                                        columns: [\n                                            {\n                                                data: 'fecha'\n                                            },\n                                            {\n                                                className: 'xS',\n                                                data: 'actividad'\n                                            },\n                                            {\n                                                data: 'hrs',\n                                                render: function (data, type, row) {\n                                                    if (parseFloat(row.hrs) > 1.0) {\n                                                        return row.hrs + ' Hrs.'\n                                                    } else {\n                                                        return row.hrs + ' Hr.'\n                                                    }\n                                                }\n                                            },\n                                            {\n                                                data: 'periodo.corte'\n                                            },\n                                            {\n                                                className: 'p-actions text-center',\n                                                data: null,\n                                                render: function (data, type, row) {\n                                                    var actions = `<a href='#!' class='btn btn-default btn-xs btn-action btn-view-report' data-id='${row.id}' data-toggle='tooltip' data-placement='top' data-title='Vista previa'><i class='fa fa-eye'></i></a>\n                                                                   <a href='../service/reporte/edit/${row.id}/proyecto/${row.proyecto_id}/periodo/${row.periodo.id}' class='btn btn-warning btn-xs btn-action btn-edit-report' data-proyecto-id='${row.proyecto_id}' data-periodo-id='${row.periodo.id}' data-id='${row.id}' data-toggle='tooltip' data-placement='top' data-title='Editar actividad'><i class='fa fa-pencil'></i></a>\n                                                                   <a href='#!' class='btn btn-danger btn-xs btn-action btn-delete-report' data-proyecto-id='${row.proyecto_id}' data-periodo-id='${row.periodo.id}' data-id='${row.id}' data-toggle='tooltip' data-placement='top' data-title='Remover actividad'><i class='fa fa-trash'></i></a>`;\n                                                    return actions;\n                                                }\n                                            },\n                                        ]\n                                    })\n                                }\n                            })\n                        })\n\n                    });\n                })\n            },\n            ordering : false,\n            pagingType: \"simple_numbers\",\n            pageLength: 8,\n            lengthChange: false,\n            searching: true,\n            info: false,\n            displayStart: 0,\n            autoWidth: false,\n            language: {\n                loadingRecords: \"Cargando...\",\n                emptyTable:     \"No se le ha asignado ningun proyecto\",\n                info:           \"Mostrando _START_ a _END_ de _TOTAL_ registros\",\n                infoEmpty:      \"Mostrando 0 a 0 de 0 registros\",\n                zeroRecords:    \"No se encontraron proyectos...\",\n                search: \"\",\n                searchPlaceholder: \"Buscar...\",\n                infoFiltered: \" - filtrado para _MAX_ registros\",\n                paginate: {\n                    first:      \"Primero\",\n                    last:       \"Último\",\n                    next:       \"Siguiente\",\n                    previous:   \"Anterior\"\n                }\n            },\n            columns: [\n                {\n                    className: 'project',\n                    data: 'nombre_proyecto',\n                    render: function(data, type, row) {\n                        var comunidad = 'N/R';\n                        if (row.comunidades.length) {\n                            if(row.comunidades[0].nombre != null) {\n                                comunidad = row.comunidades[0].nombre;\n                            }\n                        }\n                        var project = \"<div class='p-title'>\"+ row.nombre_proyecto +\"</div>\"\n                        + \"<div class='p-autor'>\"\n                            + \"<strong>Comunidad: </strong>\" + comunidad + \", <strong>Horas ejecutadas: </strong>\" + row.pivot.total_hours +\", <strong>Corte: </strong>\"+ row.periodos[0].corte;\n                        project += \"</div>\";\n                        return project;\n                    }\n                },\n                {\n                    className: 'p-actions',\n                    data: null,\n                    render: function(data, type, row) {\n                        var actions = \"<a href='#!' class='btn btn-default btn-xs btn-action btn-load-proyecto' data-id='\"+ row.id +\"' data-toggle='tooltip' data-placement='top' data-title='Ver detalles del proyecto'><i class='fa fa-eye'></i></a>\"\n                        + \"<a href='#!' class='btn btn-default btn-xs btn-action btn-register-community' data-pup-id='\"+ row.pivot.id +\"' data-id='\"+ row.id +\"' data-toggle='tooltip' data-placement='top' data-title='Registrar Asesor y Comunidad'><i class='fa fa-map-marker'></i></a>\"\n                        + \"<a href='#!' class='btn btn-primary btn-xs btn-action btn-load-list-providers' data-nombre-proyecto='\"+ row.nombre_proyecto +\"' data-pup-id='\"+ row.pivot.id +\"' data-id='\"+ row.id +\"' data-toggle='tooltip' data-placement='top' data-title='Cargar prestadores del servicio'><i class='fa fa-users'></i></a>\"\n                        + \"<a href='#!' class='btn btn-success btn-xs btn-action btn-load-activities' data-pup-id='\"+ row.pivot.id +\"' data-toggle='tooltip' data-placement='top' data-title='Ver reportes de actividades'><i class='fa fa-list-alt'></i></a>\"\n                        return actions;\n                    }\n                },\n            ]\n        })\n    })\n\n    function show_view_proyecto(data) {\n        if(Object.keys(data).length > 0) {\n            var comunidad = '-';\n            var direccion = '-';\n            var lugar_prestadores = '-';\n            if(data.comunidades.length) {\n                comunidad = data.comunidades[0].nombre + \", \" + data.comunidades[0].direccion + \", \" + data.comunidades[0].sector + \", \" + data.comunidades[0].localidad + \", \" + data.comunidades[0].provincia;\n                lugar_prestadores = data.comunidades[0].lugar_prestadores + \", \" + data.comunidades[0].direccion_lugar;\n            }\n            var box = `<div class=\"view_html\" style=\"display: none;\">\n                    <table class=\"table table-condensed table-bordered\" style=\"margin-bottom:-1px;\">\n                        <tr class=\"view_info warning\">\n                            <td colspan=\"2\" style=\"font-weight:bold;text-align:center;\">DETALLES DEL PROYECTO</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td style=\"width:110px;font-weight:bold;text-align:right;\">Descripción</td>\n                            <td>${data.descripcion}</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td style=\"font-weight:bold;text-align:right;\">Línea de acción</td>\n                            <td>${data.linea_accion}</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td style=\"font-weight:bold;text-align:right;\">Fundamentación</td>\n                            <td>${data.fundamentacion}</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td style=\"font-weight:bold;text-align:right;\">Propósito</td>\n                            <td>${data.proposito}</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td style=\"font-weight:bold;text-align:right;\">Competencia</td>\n                            <td>${data.competencia}</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td style=\"font-weight:bold;text-align:right;\">Metodología</td>\n                            <td>${data.metodologia}</td>\n                        </tr>\n                        <tr class=\"view_info\">\n                            <td colspan=\"2\">\n                                <dl>\n                                    <dt>Total horas de servicio:</dt>\n                                    <dd>${data.pivot.total_hours} hr(s)</dd>\n                                    <dt>Comunidad</dt>\n                                    <dd>${comunidad}</dd>\n                                    <dt>Lugar de acampamiento:</dt>\n                                    <dd>${lugar_prestadores}</dd>\n                                </dl>\n                            </td>\n                        </tr>\n                        </table>\n                    </div>`;\n            return box;\n        }else{\n            return;\n        }\n    }\n\n    function show_form_add_community(data) {\n        if(data) {\n            var box = '<div class=\"view_html\" style=\"display: none;\">'\n            + data\n            + '</div>';\n            $.getScript({\n                url: '/assets/js/admin/utils_community.js'\n            });\n            return box;\n        }else{\n            return;\n        }\n\n    }\n\n    function show_view_activities_list(data) {\n        if(data) {\n            var box = '<div class=\"view_html\" style=\"display: none;\">'\n            + data\n            + '</div>';\n            return box;\n        }else{\n            return;\n        }\n\n    }\n\n    function show_view_activity(data) {\n        if (Object.keys(data).length > 0) {\n            var box = `<div class=\"view_html\" style=\"display: none;\">\n                    <dl style=\"margin-bottom:5px;\">\n                        <dt>Proyecto comunitario:</dt>\n                        <dd>${data.proyecto.nombre_proyecto}</dd>\n                        <dt>Nombre de la actividad:</dt>\n                        <dd>${data.actividad}</dd>\n                        <dt>Dirección:</dt>\n                        <dd>${data.direccion}</dd>\n                        <dt>Impacto o alcance:</dt>\n                        <dd>${data.impacto_gen}</dd>\n                    </dl>\n                    </div>`;\n            return box;\n        } else {\n            return;\n        }\n    }\n\n    // FORM ADD PROVIDERS DYNAMIC ELEMENTS\n    $(\"#form-add-list-providers\").validate({\n        submitHandler: function(form) {\n            // ./RESTORE TABS ONE\n            $(\"#form-add-list-providers\").find('.tab-pane').removeClass('active');\n            $(\"#form-add-list-providers\").find('.my-tab-group-li').removeClass('active');\n            $(\"#form-add-list-providers\").find(\"#btn-tab-zero\").addClass(\"active\");\n            $(\"#form-add-list-providers\").find(\"#tab_0\").addClass(\"active\");\n            var data = $(form).serialize();\n            var request = $.ajax({\n                url: '/admin/profesor/service/myprojects/providers/project',\n                data: data,\n                type: 'POST',\n                dataType: 'json'\n            })\n            request.done(function(json) {\n                if(json.response == 'ok') {\n                    $(\"#addListProviders\").modal('hide');\n                    $(\"#addListProviders\").find(\".msg-no-providers\").hide();\n                    $(\"#addListProviders\").find(\".box-list-providers-registered\").show();\n                    $(\"#addListProviders\").find('#list-new-providers tbody').find('.row-cloned').remove();\n                    var form = $(\"#form-add-list-providers\").validate()\n                    form.resetForm();\n                    $(\"#form-add-list-providers\").trigger('reset');\n\n                    noty({\n                        text: \"Se ha guardado correctamente...\",\n                        type: 'success',\n                        theme: \"relax\",\n                        timeout: 2000, // [integer|boolean] delay for closing event in milliseconds. Set false for sticky notifications\n                        progressBar: true, // [boolean] - displays a progress bar\n                        template: '<div class=\"noty_message\"><span class=\"fa fa-check\"></span> <span class=\"noty_text\"></span><div class=\"noty_close\"></div></div>',\n                        animation: {\n                            open: 'animated bounceInDown', // Animate.css class names\n                            close: 'animated bounceOutUp', // Animate.css class names\n                            easing: 'swing', // unavailable - no need\n                            speed: 500 // unavailable - no need\n                        }\n                    })\n                }\n            })\n            request.fail(function( jqXHR, textStatus ) {\n                Utils.displayErrors(jqXHR);\n            })\n        },\n        rules: {\n            grupo: {\n                required: true,\n                number: true\n            },\n            especialidad: {\n                required: true\n            },\n            \"ci[]\": {\n                required: true,\n                number: true\n            },\n            \"firstname[]\": {\n                required: true,\n                maxlength: 50\n            },\n            \"primary_lastname[]\": {\n                required: true,\n                maxlength: 50\n            }\n        }\n    }); \n\n    function autoCompleteStudent (evt) {\n        if (this.value.length == 8) {\n            var tr = $(this).parents('tr');\n            var cells = tr[0].cells;\n            // GET PROVIDER\n            $.ajax({\n                url: '/admin/profesor/service/myprojects/providers/ci/' + this.value,\n                type: 'GET',\n                dataType: 'JSON',\n            })\n            .done(function (rs) {\n                if (rs.response == 'ok') {\n                    $(cells[1]).find('input').val(rs.student.primernombre);\n                    $(cells[2]).find('input').val((rs.student.segundonombre) ? rs.student.segundonombre : '');\n                    $(cells[3]).find('input').val(rs.student.primerapellido);\n                    $(cells[4]).find('input').val((rs.student.segundoapellido) ? rs.student.segundoapellido : '');\n                }\n            })\n            .fail(function (jqXHR) {\n                Utils.displayErrors(jqXHR);\n            })\n        }\n    }\n\n    function initCompleteStudent (evt) {\n        $(this).trigger('autoCompleteStudent');\n    }\n\n    function displayErrors(jqXHR) {\n        Utils.displayErrors(jqXHR);\n    }\n\n    $(\".ci\").on('keyup', initCompleteStudent);\n    $(\".ci\").on('autoCompleteStudent', autoCompleteStudent);\n\n    // INIT ESPECIALIDAD\n    $(\"#addListProviders\").find('#especialidad').select2();\n\n    // CLOSE MODAL ADD PRESTADORES\n    $(\"#addListProviders\").on('hide.bs.modal', function() {\n        // ./REMOVE TABS\n        $(this).find(\".my-tab-group-li\").remove();\n        $(this).find(\".content-table\").remove();\n        // ./RESTORE TABS ONE\n        $(this).find(\"#btn-tab-zero\").addClass(\"active\");\n        $(this).find(\"#tab_0\").addClass(\"active\");\n\n        $(this).find('#list-new-providers tbody').find('.row-cloned').remove();\n        var form = $(\"#form-add-list-providers\").validate()\n        form.resetForm();\n        $(\"#form-add-list-providers\").trigger('reset');\n    })\n\n    // Activate link\n    var url = $(\"#url-active\").data(\"url-active\");\n    global.url_active(url);\n})"]}